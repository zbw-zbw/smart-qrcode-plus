# 需求文档

## Smart QRCode Plus - 浏览器扩展插件

### 一、产品概述

**产品名称**：Smart QRCode Plus

**产品类型**：Chrome 浏览器扩展插件

**目标用户**：

- 前端开发者
- 产品经理 / 运营人员
- 有二维码分享或 URL 参数调试需求的用户
- 需要解析二维码内容的用户

**核心价值**：

- 快速将当前页面链接生成二维码，便于扫码访问
- 可视化拆解并编辑 URL 参数，快速调试和复用
- 实时预览修改后的二维码，提升效率
- 智能识别和解码二维码图片，提取链接信息

---

### 二、核心功能模块

#### 1. 自动生成当前标签页二维码

- 获取当前激活标签页的 URL
- 生成二维码并渲染至 UI（使用 canvas 或 SVG）
- 支持复制 / 下载二维码图像

#### 2. 手动输入/编辑链接生成二维码

- 提供 URL 输入框，支持手动粘贴、修改链接
- 输入变化后实时更新二维码
- 对非法 URL 自动提示并禁用二维码渲染

#### 3. URL 参数解析与编辑

- 自动解析 URL 中 query 参数，显示为键值表格
- 表格内支持：
  - 编辑参数值（实时更新）
  - 删除参数
  - 添加新参数
- 所有操作实时反映到 URL 和二维码

#### 4. 二维码解码功能 ⭐️ **新增**

##### 4.1 图片上传解码
- 点击上传按钮选择本地图片文件
- 支持常见图片格式：PNG、JPG、JPEG、GIF、WebP
- 自动识别图片中的二维码并解析内容
- 显示解码进度和状态提示

##### 4.2 剪贴板图片解码
- 自动检测剪贴板中的图片内容
- 支持截图、复制的图片直接粘贴解码
- 快捷键：Ctrl+V 或右键粘贴触发
- 无需手动保存图片，直接处理内存中的图像数据

##### 4.3 网络图片URL解码
- 提供图片URL输入框
- 支持CDN、直链等网络图片地址
- 自动加载远程图片并进行二维码识别
- 处理跨域问题和加载失败情况

##### 4.4 解码结果处理
- **结果展示**：清晰显示解码出的文本/链接内容
- **一键操作**：
  - 复制解码结果到剪贴板
  - 直接在新标签页中打开链接（如果是URL）
  - 替换当前编辑的URL（无缝切换到编辑模式）
- **智能识别**：
  - 自动判断解码内容类型（URL、文本、其他）
  - 对于URL，自动进入参数解析编辑流程
  - 非URL内容提供纯文本展示和复制功能

#### 5. 快捷操作

- 复制当前 URL
- 复制二维码链接 / 下载二维码
- 一键恢复原始 URL（重置参数）
- 快速切换生成/解码模式

#### 6. 可选功能（增强体验）

- 二维码大小、配色可设置（默认样式即可）
- 是否开启 URL 自动更新监听（支持 SPA 页面）
- 解码历史记录存储和快速访问
- Options 页面支持偏好设置存储

---

### 三、页面结构 & 交互说明

#### Popup 页面（主页面）结构

```
+------------------------------------------------+
| Smart QRCode Plus                             |
| [生成模式] [解码模式] ←← 模式切换               |
+------------------------------------------------+
| 生成模式：                                     |
| 当前链接：                                     |
| [ https://example.com?foo=1&bar=2 ] [编辑]     |
+------------------------------------------------+
| 二维码显示区域                                 |
| [canvas/svg 实时渲染]                          |
+------------------------------------------------+
| URL 参数列表：                                 |
| foo = 1   [编辑] [删除]                        |
| bar = 2   [编辑] [删除]                        |
| [+ 添加参数]                                   |
+------------------------------------------------+
| [复制链接] [复制二维码] [下载二维码]          |
+------------------------------------------------+

+------------------------------------------------+
| 解码模式：                                     |
+------------------------------------------------+
| [上传图片] [粘贴图片] [图片URL输入框]          |
+------------------------------------------------+
| 解码结果显示区域                               |
| 类型：URL                                      |
| 内容：https://example.com?test=123             |
+------------------------------------------------+
| [复制结果] [打开链接] [编辑参数]              |
+------------------------------------------------+
```

---

### 四、技术选型

- 前端框架：React + TypeScript + Tailwind CSS（或 UnoCSS）
- 打包构建：Vite + crxjs/vite-plugin
- 二维码生成：qrcode.react 或 qrcode 库
- **二维码解码：qr-scanner 或 jsQR 库** ⭐️ **新增**
- **图像处理：canvas API + File API** ⭐️ **新增**
- Chrome 插件标准：Manifest v3

---

### 五、开发计划

#### 阶段 1：插件结构搭建（Day 1）

- 搭建 React + Vite + Manifest V3 插件骨架
- 实现 popup 页面基础布局
- 添加生成/解码模式切换

#### 阶段 2：二维码生成功能（Day 2-3）

- 获取当前标签页链接
- 生成二维码 & 下载 / 复制功能
- 手动输入 URL 修改二维码

#### 阶段 3：URL 参数解析与编辑（Day 4-5）

- 拆解 URL 参数为键值表格
- 实现参数的增删改功能
- 实时同步链接和二维码更新

#### 阶段 4：二维码解码功能（Day 6-8） ⭐️ **新增**

- 集成二维码识别库（jsQR / qr-scanner）
- 实现图片上传和文件处理
- 开发剪贴板图片检测和处理
- 实现网络图片URL加载和解码
- 解码结果展示和后续操作

#### 阶段 5：可选增强功能（Day 9-10）

- 样式优化（Tailwind）
- 支持设置二维码尺寸 / 颜色
- 解码历史记录功能
- Options 页面开发 & 本地存储偏好

---

### 六、可扩展性

- 支持 URL 模板保存 & 历史记录
- 接入短链接服务（如 Bit.ly）
- 支持 iframe 中页面链接解析
- **支持批量二维码解码** ⭐️ **新增**
- **支持多种编码格式识别（条形码等）** ⭐️ **新增**
- 国际化支持（i18n）

---

### 七、备注

- 插件默认权限应控制在最小（"activeTab"、"scripting"）
- **新增权限需求：处理剪贴板图片可能需要 "clipboardRead" 权限** ⭐️ **新增**
- 安全性：防止 XSS，限制不可信输入，验证图片文件安全性
- 所有操作需保证前端本地完成（不依赖后端）
- **二维码解码完全在本地进行，保护用户隐私** ⭐️ **新增**

---

> 备注：本 PRD 可作为 Cursor 项目创建和分阶段开发的蓝图使用。**v2.0版本新增二维码解码功能，实现双向二维码处理能力。**

